import{B as j,r as p,a as R,ab as _,f as b,j as I,k as a,m as e,G as Q,n as B,Q as W,q as v,t as S,Y as s,E as G,s as u,bt as T,W as h,H as O,bu as Y,a0 as U,a2 as D,a3 as k,V as z,bk as N}from"./index.46a27899.js";import{Q as y}from"./QField.e3e9fc47.js";import{Q as H}from"./QForm.143d2f76.js";import{a as f,Q as J}from"./QPageSticky.81a02079.js";import{a as K,Q as M,d as X}from"./QToolbar.3af662a7.js";import{Q as Z,a as r}from"./QItemLabel.0564320f.js";import{Q as ee}from"./QPage.7824d0da.js";import{u as le}from"./use-quasar.20dd07d7.js";import{g as te,s as ae,d as ne}from"./transaction.45dcaa38.js";import{f as oe}from"./account-group.879321a1.js";import{u as ue,A as w}from"./account.00e1e43f.js";import{u as de}from"./key.dfec5238.js";import"./use-page-sticky.f7fef31c.js";import"./QResizeObserver.5ab78c49.js";import"./currency.9051c79a.js";import"./currency.es.c7e1cdbb.js";import"./account-group.3c4ddb1d.js";const se=u("div",{style:{"padding-top":"50px"}},null,-1),ie={class:"flex justify-end full-width"},re={class:"flex justify-end full-width"},me={class:"flex justify-end full-width"},pe={class:"flex justify-end full-width"},fe=u("div",null,"\u3010\u5F53\u65E5\u5165\u8D26\u3011\uFF1A\u8D26\u5355\u65E5\u5F53\u5929\u7684\u6D88\u8D39\u8BA1\u5165\u5F53\u671F\u8D26\u5355\u3002",-1),ce=u("div",null,"\u3010\u9694\u65E5\u5165\u8D26\u3011\uFF1A\u8D26\u5355\u65E5\u5F53\u5929\u7684\u6D88\u8D39\u8BA1\u5165\u4E0B\u671F\u8D26\u5355\u3002",-1),ve=u("div",null,"\u82E5\u8FD8\u6B3E\u65E5\u7C7B\u578B\u662F\u56FA\u5B9A\u65E5\u671F\uFF0C\u8868\u793A\u6BCF\u6708\u56FA\u5B9A\u7684\u67D0\u4E00\u65E5\u8FD8\u6B3E\u3002",-1),ye=u("div",null," \u82E5\u8FD8\u6B3E\u65E5\u7C7B\u578B\u662F\u56FA\u5B9A\u5929\u6570\uFF0C\u8868\u793A\u5728\u8D26\u5355\u65E5\u4E0A\u52A0\u591A\u5C11\u65E5\u662F\u8FD8\u6B3E\u65E5\u3002 ",-1),ge=u("div",null,"\u8BE6\u89C1\u8FD8\u6B3E\u65E5\u671F\u8BF4\u660E",-1),Ee={__name:"AccountEdit",setup(Ve){const{id:i,titlePrefix:A}=de(j().params.accountId),c=le(),P=ue(),g=p(null),V=p(!1),m=p(!1),C=p([]),t=p({id:i,name:void 0,cardNo:void 0,type:"Cash",currency:"CNY",openingBalance:0,balance:0,creditLimit:void 0,settlementDay:void 0,settlementDayEntryDate:0,entryPeriod:1,duePeriod:void 0,duePeriodType:"FixedDate",includeInNetWorth:!0,groupId:void 0,notes:""});oe().then(o=>C.value=o.data),i&&te(i).then(o=>{t.value=o.data});const x=()=>{V.value=!0},E=N(()=>{ae({...t.value}).then(()=>{c.notify(`\u5DF2\u6210\u529F\u4FDD\u5B58\u8D26\u6237:${t.value.name}`),P.publish({id:i},w.ADDED),g.value.goBack()}).catch(o=>{var l,d;c.notify({type:"negative",message:((d=(l=o==null?void 0:o.response)==null?void 0:l.data)==null?void 0:d.message)||"\u4FDD\u5B58\u8D26\u6237\u5931\u8D25"})}).finally(()=>m.value=!1)},1e3),L=N(()=>{m.value=!0,ne(i).then(()=>{c.notify(`\u5DF2\u5220\u9664\u8D26\u6237:${t.value.name}`),P.publish({id:i},w.DELETED),g.value.goBack()}).catch(o=>{var l,d;c.notify({color:"negative",message:((d=(l=o==null?void 0:o.response)==null?void 0:l.data)==null?void 0:d.message)||"\u8D26\u6237\u5220\u9664\u5931\u8D25"})}).finally(()=>m.value=!1)},1e3),F=R(()=>{const o=t.value.duePeriod||"{\u8FD8\u6B3E\u5468\u671F}",l=t.value.duePeriodType;return l==="FixedDate"?`\u6BCF\u6708${o}\u65E5\u8FD8\u6B3E`:l==="FixedDays"?`\u51FA\u8D26${o}\u5929\u540E\u8FD8\u6B3E`:o});return(o,l)=>{const d=_("DeleteConfirmBtn"),q=_("nav-bar"),$=_("InputSingleListSheet");return b(),I(ee,null,{default:a(()=>[e(q,{ref_key:"navBarRef",ref:g},{btn:a(()=>[t.value.id?(b(),I(d,{key:0,loading:m.value,content:t.value.name,onClick:Q(L)},null,8,["loading","content","onClick"])):B("",!0),e(W,{flat:"",round:"",icon:"save",loading:m.value,onClick:l[0]||(l[0]=n=>o.$refs.formRef.submit())},null,8,["loading"])]),default:a(()=>[v(S(Q(A))+"\u8D26\u6237 ",1)]),_:1},512),se,e(H,{ref:"formRef",class:"q-pa-md q-gutter-y-md",greedy:"",onSubmit:Q(E)},{default:a(()=>[e(s,{modelValue:t.value.name,"onUpdate:modelValue":l[1]||(l[1]=n=>t.value.name=n),"input-class":"text-right",prefix:"\u8D26\u6237\u540D\u79F0",dense:"","lazy-rules":"",rules:[n=>(n==null?void 0:n.length)||"\u8BF7\u8F93\u5165\u8D26\u6237\u540D\u79F0"]},null,8,["modelValue","rules"]),e($,{modelValue:t.value.groupId,"onUpdate:modelValue":l[2]||(l[2]=n=>t.value.groupId=n),"input-class":"text-right",prefix:"\u8D26\u6237\u5206\u7EC4",dense:"",items:C.value},null,8,["modelValue","items"]),e(s,{modelValue:t.value.cardNo,"onUpdate:modelValue":l[3]||(l[3]=n=>t.value.cardNo=n),"input-class":"text-right",prefix:"\u5361\u53F7",dense:""},null,8,["modelValue"]),e(s,{modelValue:t.value.openingBalance,"onUpdate:modelValue":l[4]||(l[4]=n=>t.value.openingBalance=n),"input-class":"text-right",prefix:"\u4F59\u989D",type:"number",dense:""},null,8,["modelValue"]),t.value.type=="Credit"?(b(),G(O,{key:0},[e(s,{modelValue:t.value.creditLimit,"onUpdate:modelValue":l[5]||(l[5]=n=>t.value.creditLimit=n),"input-class":"text-right",prefix:"\u4FE1\u7528\u989D\u5EA6",type:"number",dense:""},null,8,["modelValue"]),e(s,{modelValue:t.value.settlementDay,"onUpdate:modelValue":l[6]||(l[6]=n=>t.value.settlementDay=n),"input-class":"text-right",prefix:"\u8D26\u5355\u65E5",type:"number",dense:""},null,8,["modelValue"]),e(y,{prefix:"\u5165\u8D26\u5468\u671F",dense:""},{control:a(()=>[u("div",ie,[e(T,{modelValue:t.value.entryPeriod,"onUpdate:modelValue":l[7]||(l[7]=n=>t.value.entryPeriod=n),type:"radio",dense:"",inline:"",options:[{label:"\u5F53\u65E5\u5165\u8D26",value:0},{label:"\u9694\u65E5\u5165\u8D26",value:1}]},null,8,["modelValue"])])]),append:a(()=>[e(h,{name:"help_outline",class:"cursor-pointer",onClick:x})]),_:1}),e(y,{prefix:"\u8FD8\u6B3E\u65E5\u671F",dense:""},{control:a(()=>[u("div",re,S(F.value),1)]),_:1}),e(s,{modelValue:t.value.duePeriod,"onUpdate:modelValue":l[8]||(l[8]=n=>t.value.duePeriod=n),"input-class":"text-right",prefix:"\u8FD8\u6B3E\u5468\u671F",type:"number",dense:""},{append:a(()=>[e(h,{name:"help_outline",class:"cursor-pointer",onClick:x})]),_:1},8,["modelValue"]),e(y,{"input-class":"text-right",prefix:"\u8FD8\u6B3E\u65E5\u671F\u7C7B\u578B",dense:""},{control:a(()=>[u("div",me,[e(T,{modelValue:t.value.duePeriodType,"onUpdate:modelValue":l[9]||(l[9]=n=>t.value.duePeriodType=n),type:"radio",inline:"",dense:"",options:[{label:"\u56FA\u5B9A\u65E5\u671F",value:"FixedDate"},{label:"\u56FA\u5B9A\u5929\u6570",value:"FixedDays"}]},null,8,["modelValue"])])]),append:a(()=>[e(h,{name:"help_outline",class:"cursor-pointer",onClick:x})]),_:1})],64)):B("",!0),e(y,{"input-class":"text-right",prefix:"\u662F\u5426\u8BA1\u5165\u8D44\u4EA7",dense:""},{control:a(()=>[u("div",pe,[e(Y,{modelValue:t.value.includeInNetWorth,"onUpdate:modelValue":l[10]||(l[10]=n=>t.value.includeInNetWorth=n),dense:""},null,8,["modelValue"])])]),_:1}),e(s,{modelValue:t.value.notes,"onUpdate:modelValue":l[11]||(l[11]=n=>t.value.notes=n),"input-class":"text-right",prefix:"\u5907\u6CE8",type:"textarea",dense:"",rows:"3"},null,8,["modelValue"])]),_:1},8,["onSubmit"]),e(J,{expand:"",position:"top"},{default:a(()=>[e(K,{class:"q-pa-none"},{default:a(()=>[e(M,null,{default:a(()=>[e(U,{flat:"",class:"border-bottom"},{default:a(()=>[e(X,{modelValue:t.value.type,"onUpdate:modelValue":l[12]||(l[12]=n=>t.value.type=n),align:"justify"},{default:a(()=>[e(f,{label:"\u73B0\u91D1",name:"Cash"}),e(f,{label:"\u50A8\u84C4\u5361",name:"Debit"}),e(f,{label:"\u4FE1\u7528\u5361",name:"Credit"}),e(f,{label:"\u6295\u8D44\u8D26\u6237",name:"Investment"}),e(f,{label:"\u8D37\u6B3E\u8D26\u6237",name:"Loan"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(z,{modelValue:V.value,"onUpdate:modelValue":l[13]||(l[13]=n=>V.value=n),position:"bottom"},{default:a(()=>[e(U,{class:"full-width q-py-md"},{default:a(()=>[e(Z,null,{default:a(()=>[e(D,null,{default:a(()=>[e(k,null,{default:a(()=>[e(r,null,{default:a(()=>[v("\u5165\u8D26\u5468\u671F")]),_:1}),e(r,{caption:"",lines:"2"},{default:a(()=>[fe,ce]),_:1})]),_:1})]),_:1}),e(D,null,{default:a(()=>[e(k,null,{default:a(()=>[e(r,null,{default:a(()=>[v("\u8FD8\u6B3E\u5468\u671F")]),_:1}),e(r,{caption:"",lines:"2"},{default:a(()=>[ve,ye]),_:1})]),_:1})]),_:1}),e(D,null,{default:a(()=>[e(k,null,{default:a(()=>[e(r,null,{default:a(()=>[v("\u8FD8\u6B3E\u65E5\u671F\u7C7B\u578B")]),_:1}),e(r,{caption:"",lines:"2"},{default:a(()=>[ge]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{Ee as default};
